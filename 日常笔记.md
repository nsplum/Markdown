[TOC]

### NoteBook for Spark 安装过程

参考文档
`https://toree.apache.org/docs/current/user/how-it-works/`
`https://toree.apache.org/docs/current/user/quick-start/`

1. 安装toree
    `pip install toree`
2. 安装kernel
     `jupyter toree install --spark_home=path/to/your/spark_directory --interpreters=PySpark`
3. 显示安装的kernel
     `jupyter kernelspec list`
4. 安装其他的kernel
     `jupyter toree install --interpreters=Scala,SparkR,SQL`
5. 注意事项
     - a) 如果直接pip install toree可能安装的toree版本为0.1.0,目前好像不支持spark 2.2.1，所以需要安装toree的0.2.0版本。
        `pip install https://dist.apache.org/repos/dist/dev/incubator/toree/0.2.0/snapshots/dev1/toree-pip/toree-0.2.0.dev1.tar.gz`
     - b) 安装的核心配置文件在如下目录
       例如：
       `/usr/local/share/jupyter/kernels/apache_toree_pyspark`

### MacOS下安装多版本JDK与切换几种方式

安装路径一般在如下目录
`/Library/Java/JavaVirtualMachines`
例如：
JDK 1.7&1.8:
`/Library/Java/JavaVirtualMachines/jdk1.7.0_45.jdk`
`/Library/Java/JavaVirtualMachines/jdk1.8.0_25.jdk`

修改.bash_profile文件,通过vi .bash_profile 在该文件中输入以下内容：

``` shell
# 设置 JDK 9
export JAVA_9_HOME=`/usr/libexec/java_home -v 1.+`
# 设置 JDK 8
export JAVA_8_HOME=`/usr/libexec/java_home -v 1.8`

#默认JDK 8
export JAVA_HOME=$JAVA_8_HOME

#alias命令动态切换JDK版本
alias jdk9="export JAVA_HOME=$JAVA_9_HOME"
alias jdk8="export JAVA_HOME=$JAVA_8_HOME"
```

然后执行source .bash_profile生效新配置 

### Conda的基本使用与安装TensorFlow
#### Conda基本使用
- 1、首先在所在系统中安装Anaconda。可以打开命令行输入conda -V检验是否安装以及当前conda的版本。 
- 2、conda常用的命令。
    1） conda list  查看安装了哪些包。
    2）conda env list  或 conda info -e 查看当前存在哪些虚拟环境
    3）conda update conda  检查更新当前conda
- 3、创建python虚拟环境。
     使用 conda create -n your_env_name python=X.X（2.7、3.6等）  anaconda 命令创建python版本为X.X、名字为your_env_name的虚拟环境。your_env_name文件可以在Anaconda安装目录envs文件下找到。
- 4、使用激活(或切换不同python版本)的虚拟环境。
    打开命令行输入python --version可以检查当前python的版本。
    使用如下命令即可 激活你的虚拟环境(即将python的版本改变)。
    Linux:  source activate your_env_name(虚拟环境名称)
    Windows: activate your_env_name(虚拟环境名称)
   这是再使用python --version可以检查当前python版本是否为想要的。
- 5、对虚拟环境中安装额外的包。
    使用命令conda install -n your_env_name [package]即可安装package到your_env_name中
- 6、关闭虚拟环境(即从当前环境退出返回使用PATH环境中的默认python版本)。
   使用如下命令即可。
   Linux: source deactivate
   Windows: deactivate
- 7、删除虚拟环境。
   使用命令conda remove -n your_env_name(虚拟环境名称) --all， 即可删除。
- 8、删除环境中的某个包。
   使用命令conda remove --name $your_env_name  $package_name 即可。

#### TensorFlow安装
安装TensorFlow
- 先建立一个Python 的虚拟环境
`conda create -n tensorflow python=3.6 `

- 进入虚拟环境tensorflow中
`source activate tensor flow`

- 安装tensorflow
`pip install --upgrade https://github.com/lakshayg/tensorflow-build/raw/master/tensorflow-1.4.1-cp36-cp36m-macosx_10_13_x86_64.whl`

- //
`pip install --upgrade tensorflow `
`pip install protobuf==3.4.0`

### 手工精简 迅雷 for MAC

方法来自XX论坛的aho，觉得方法不错，就转了过来

路径：应用程序——迅雷——Contents——PlugIns

```
advertising.xlplugin            左下角live提示广告（删除）
applications.xlplugin           应用（不建议删除，因为偏好设定及离线空间依赖该页面）
bbassistant.xlplugin            宽带助手 （可删除）
browserhelper.xlplugin          浏览器支持（可删除）
details.xlplugin                任务详情/评论（可删除，删除后无法查看任务详情）
featuredpage.xlplugin           精选（删除）
myvip.xlplugin                  我的会员（删除）
playgame.xlplugin               玩一玩（删除）
settings.xlplugin               偏好设定（不建议删除，删除后无法设置）
subtitle.xlplugin               搜索字幕（可删除，删除后无法进行右键搜索字幕）
thunderstore.xlplugin           软件中心（删除）
viprenew.xlplugin               立即续费提示（删除）
xiazaibao.xlplugin              下载宝（删除）
xlbrowser.xlplugin              搜索（删除）
xlplayer.xlplugin               迅雷播放器（删除，删除后点击播放自动调用QuickTime Player播放）
```


### 使用conda管理python环境

#### 一、动机
最近打算折腾vn.py，但只有py27版本的，因为一向习惯使用最新稳定版的，所以不得不装py27的环境，不得不说 
Python 的全局锁真的很烦。 
身为懒癌患者，必然使用全功能的anaconda，但不想同时装py27和py35两个版本的anaconda巨无霸（同时装两个， 
不知道conda是否也可以管理环境），于是选择用conda装python27的环境及一些必要的包。 
弄了几天终于把办公电脑和家里的Mac机上的环境都配好了，即使有了官方的安装教材，也踩了不少坑。 
( 因为国内主要的期货交易API接口只有windows和linux版，所以Mac上的环境只能用来回测，无法使用vn.py的模拟交易和实盘功能。)
#### 二、环境管理
conda常用命令
1. 查看当前系统下的环境
`conda info -e`
1. 创建新的环境

``` shell
# 指定python版本为2.7，注意至少需要指定python版本或者要安装的包# 后一种情况下，自动安装最新python版本
conda create -n env_name python=2.7
# 同时安装必要的包
conda create -n env_name numpy matplotlib python=2.7
```

1. 环境切换
``` shell
# 切换到新环境# linux/Mac下需要使用source activate env_name
activate env_name
#退出环境，也可以使用`activate root`切回root环境
deactivate env_name
```

1. 移除环境
`conda remove -n env_name --all`

#### 三、包管理
给某个特定环境安装package有两个选择，一是切换到该环境下直接安装，二是安装时指定环境参数-n
`activate env_nameconda install pandas`
``` shell
# 安装anaconda发行版中所有的包
conda install anaconda
conda install -n env_name pandas
```
1. 查看已经安装的package
```
conda list
# 指定查看某环境下安装的package
conda list -n env_name
```

1. 查找包
`conda search pyqtgraph`
1. 更新包
`conda update numpy`
`conda update anaconda`
1. 卸载包
`conda remove numpy`

#### 四、vnpy环境配置中遇到的疑难杂症
1. 64位系统和root环境下指定安装32位
vnpy在window系统下使用的python版本和package都是32位的，但除非下载anaconda时就下载32位版本,现在大多数系统都是64位了吧，我装的也是64位，那么用conda安装时默认64位，stackoverflow了发现解决方案，安装前设置使用32位：

    ```
    # 设置32位set CONDA_FORCE_32BIT=1
    conda create -n env_name python=2.7
    conda install numpy pandas
    # 切回系统默认set CONDA_FORCE_32BIT=
    ```

1. 设置国内镜像
家里用的长城宽带，访问国外资源的网速简直不能忍，于是看了下conda有没有国内的镜像。然后真找到了一个 
清华大学TUNA镜像清华大学 TUNA 镜像源
网站有添加方法
    ``` shell
    # 需要去掉网址的引号
    conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --set show_channel_urls yes

    如果命令行方法添加不上，可以在用户目录下的.condarc中添加https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/： 

    如果没有该文件可以直接创建，Windows为C://Users/username/.condarc，Linux/Mac为~/.condarc
    结果如下：
    channels:
    - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/ 
    - defaults
    show_channel_urls: yes
    ```
    





数学公式，GitHub不支持
$ y=sin(x)$